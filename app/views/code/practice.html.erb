<!DOCTYPE html>
<html>
<head>
    <% content_for :title, "HTML Practice" %>
 <link rel="stylesheet" href="http://codemirror.net/lib/codemirror.css">
<link rel="stylesheet" href="http://codemirror.net/theme/monokai.css">
<script src="http://codemirror.net/lib/codemirror.js"></script>
<script src="http://codemirror.net/mode/xml/xml.js"></script>
<script src="http://codemirror.net/mode/javascript/javascript.js"></script>
<script src="http://codemirror.net/mode/css/css.js"></script>
    <script src="http://codemirror.net/mode/htmlmixed/htmlmixed.js"></script>
    <script src="http://codemirror.net/addon/edit/closetag.js"></script>
    </head>
    <body>
    <div class="navbar navbar-inverse">
        <ul class="nav">
        	<%= link_to main_index_path do %>
       		<%= image_tag("EmeraldLogo.png", :class => "navbar-brand") %>
       		<% end %>
        <div class="dropdown">
            <%= image_tag(current_user.avatar.url(:thumb), :class => "round-image-50 dropdown-toggle", :data => {:toggle => "dropdown"}) %>
            <ul class="dropdown-menu">
            <li><%= link_to "Practice", code_langselect_path %></li>
            <li class="divider"></li>
            <li><%= link_to "Log Out", destroy_user_session_path, :method => :delete %></li>
            <li><%= link_to "Edit Profile", edit_user_registration_path %></li>
            </ul>
        </div>
        </ul>
    </div>
    <style type="text/css">
	body {
		margin: 0px;
		padding: 0px;
        overflow: hidden;
	}
	.round-image-50 {
    background-color: white;
    border: 1px solid #d9d9d9;
    border-radius: 25px;
    -moz-border-radius: 25px;
    -webkit-border-radius: 25px;
    height: 50px;
    width: 50px;
    overflow: hidden;
    cursor: pointer;
    img { width: 100% }
}
.dropdown{
    left:80%;
    position: relative;
}
    .btn-default {
        left:80%;
        position:relative;
        top:10px;
    }
    </style>

<form style="width:500px; height:100%;"><textarea id="code" name="code">
    <DOCTYPE! html>
    <html>
        <head>
            <title></title>
        </head>
        <body>
            
        </body>
        </html></textarea></form>
<script>
      var delay;
      var editor = CodeMirror.fromTextArea(document.getElementById("code"), {mode: "text/html", tabMode: "indent",
                    lineNumbers: true,
                    lineWrapping: true, theme: "monokai"});
      editor.on("change", function() {
        clearTimeout(delay);
        delay = setTimeout(updatePreview, 300);
      });
      
      function updatePreview() {
        var previewFrame = document.getElementById('preview');
        var preview =  previewFrame.contentDocument ||  previewFrame.contentWindow.document;
        preview.open();
        preview.write(editor.getValue());
        preview.close();
      }
      setTimeout(updatePreview, 300);
    
</script>
</body>
</html>